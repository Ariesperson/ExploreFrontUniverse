<!DOCTYPE html>
<html class="partner cabin">

<head>
    <meta charset="UTF-8" />
    <meta name="author" content="dmall" />
    <meta name="description" content="å¤šç‚¹ï¼Œå¤šç‚¹æ–°é²œï¼ŒDmallï¼Œå¤šç‚¹å•†åŸï¼Œå¤šç‚¹æ–°é²œï¼Œç”Ÿæ´»ï¼ŒæœåŠ¡ï¼Œç”Ÿé²œï¼Œé…é€" />
    <meta name="keywords" content="å¤šç‚¹ï¼Œå¤šç‚¹æ–°é²œï¼ŒO2Oï¼ŒDmallï¼Œå¤šç‚¹å•†åŸï¼Œå¤šç‚¹æ–°é²œï¼Œç”Ÿæ´»ï¼ŒæœåŠ¡ï¼Œç”Ÿé²œï¼Œé…é€" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="format-detection" content="telephone=no" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>å¤šç‚¹é£æ‹“</title>
    <link rel="icon" type="image/png" href="https://img.dmallcdn.com/dshop/202205/bdcb3f6e-bff6-4fa5-827a-1c0a332ff9eb" sizes="256x256"/>
    <script type="application/javascript"
        data-src="??kayak-lib/dist/kayak-lib/jquery2.2.3/jquery-2.2.3.js,kayak-lib/dist/kayak-lib/seajs3.0/sea-debug.js,kayak-lib/dist/kayak-lib/seajs3.0/config.js,kayak-lib/dist/kayak-lib/arttemplate3.0/template-native.js,kayak-lib/dist/kayak-lib/fastclick/fastclick.js,kayak/dist/kayak/plugin/plugin.js">
    </script>
    <script data-src="entry_html/dist/js/env.js"></script>
    <style>
        dl,ol,ul {
            margin-top: 0;
            padding: 0px;
        }
        li {
            list-style: none;
        }
        /* å¤„ç†ç§»åŠ¨ç«¯é¡µé¢é«˜åº¦é—®é¢˜ */
       .cabinfull,
       .right-content,
       .content-container {
           height: 100%;
       }
    </style>
</head>

<body>
    <!-- è¿›å…¥é¡µé¢åŠæ˜¾ç¤ºloadingï¼Œä»¥å…å‡ºç°é•¿æ—¶é—´ç©ºç™½ç•Œé¢ -->
    <div class="body-loading show">
        <div class="vertical-box">
            <div class="content"><i class="loader"></i></div>
        </div>
        <div class="mask"></div>
    </div>
    <script>
        (function () {
            //cmd è½¬ amd
            window.aDefine = function (id, deps, factory) {
                
                define(id, deps, function (require, exports, module) {
                    var depOjbs = [];
                    if (deps && deps.length > 0) {
                        deps.forEach(function (v, k) {
                            depOjbs.push(require(v));
                        });
                    }

                    if (factory && typeof factory === "function") {
                        var exp = factory.apply(this, depOjbs);
                        if (exp && exp.default) {
                            //å¦‚æœæ˜¯ä¸€ä¸ªcabiné¡µé¢ï¼Œåˆ™è½¬ç§»ä¸€äº›å˜é‡st
                            if (exp.default.cabinVue) {
                                exp.default.cabinVue.render = exp.default.render;
                                exp.default.cabinVue.staticRenderFns = exp.default.staticRenderFns;
                                exp.default.cabinVue.__file = exp.default.__file;
                                exp.default.cabinVue._compiled = exp.default._compiled;
                                exp.default.cabinVue._scopeId = exp.default._scopeId;
                            }
                            //å¦‚æœæ˜¯ä¸€ä¸ªcabiné¡µé¢ï¼Œåˆ™è½¬ç§»ä¸€äº›å˜é‡ed
                            module.exports = exp.default;
                        } else {
                            module.exports = exp;
                        }
                    }
                });
            };
            // è¿™é‡Œè¿›è¡Œé¡¹ç›®æ›¿æ¢
            window.kayak = window.kayak || {};
            window.kayak.bizDomain = getBizDomain();
            window.kayak.root = getSourceRoot();
            window.kayak.EVT = getEvt();
            window.kayak.urlRequest = getRequest();
            // æ·»åŠ å…¥å£loadingæ ·å¼
            document.write('<link rel="stylesheet" href="' + window.kayak.root +
                "dmall_fit_jichu_partner_front/dist/dmall_fit_jichu_partner_front/assets/styles/partner-loading.css?_=" + new Date().getTime() + '">');
            // document.write('<link rel="stylesheet" href="http://testlocal.dmall.com/kayak-project/partner/src/partner/common/style/index-loading.css?_='+(new Date()).getTime()+'">');//test
            document.write('<script src="' + window.kayak.root +
                'kayak-lib/dist/kayak-lib/jsloader/jsloader.js" type="application/javascript"><\/script>');

            document.write('<script src="' + window.kayak.root +
                'dmall_fit_traffic_js_sdk/dist/dmallanlytic.js" type="application/javascript"><\/script>');
            // å¼•å…¥ç»„ä»¶åŒ–æ”¯æŒçš„js
            // document.write( '<script src="' +  window.kayak.EVT + "helpcentercomponent.dmall.com/1.1.0/bundle.js?_=" + new Date().getTime() + '" type="application/javascript"><\/script>');
            // å…¨é“¾è·¯ç°åº¦é€»è¾‘
            document.write('<script src="' +  'https://api-tenant.fit.dmall.com/app/nessau/route/projectChart.js?_=' + (new Date()).getTime() + '" type="application/javascript"><\/script>');

            /**
             * è·å–å½“å‰é¡µé¢çš„ä¸šåŠ¡åŸŸå
             * @param {string} domain éå¿…ä¼ å‚æ•°
             * @return {string} bizDomain ä¸šåŠ¡åŸŸå
             * ç¤ºä¾‹:
                (1) 'demo.dmall.com.cn' => 'dmall.com.cn'
                (2) 'demo.dmall.com' => 'dmall.com'
                (3) 'demo.dmall-os.cn' => 'dmall-os.cn'
            */
            //è·å–ä¸šåŠ¡åŸŸåçš„å°è£…æ–¹æ³•
            function getBizDomain( domain ) {
                var domainList = ( domain || document.domain ).split( '.' );
                if( domainList.length > 2 ){
                    domainList.shift();
                }
                return domainList.join( '.' )
            }

            function getSourceRoot() {
                var param = getRequest();
                var domainReg = new RegExp("//[A-Za-z0-9]+." + 'fit.dmall.com');
                // è°ƒè¯•æ¨¡å¼èµ°è°ƒè¯•åœ°å€
                if (
                    param.debuglocation &&
                    domainReg.test(param.debuglocation)
                ) {
                    return param.debuglocation
                }
                // é»˜è®¤èµ°ç¯å¢ƒ+é™æ€èµ„æºè·¯å¾„
                return getEvt() + 'static.fit.dmall.com/kayak-project/'
            }

            function getEvt() {
                var href = window.location.href, result = '';
                if (href.indexOf('//test') > 0 && href.indexOf('//test.') == -1) {
                    result = '//test';
                } else if (href.indexOf('//mid') > 0 && href.indexOf('//mid.') == -1) {
                    result = '//mid';
                } else if (href.indexOf('//dev') > 0 && href.indexOf('//dev.') == -1) {
                    result = '//dev';
                } else if (href.indexOf('//uat') > 0 && href.indexOf('//uat.') == -1) {
                    result = '//uat';
                } else if (href.indexOf('//rd-') > 0 && href.indexOf('//rd-.') == -1) {
                    result = '//rd-';
                } else {
                    result = '//';
                }
                return result;
            }

            function getRequest(type) {
                var url, theRequest = {},
                    i, strs;
                var $win = window.top || window;
                type = type || "search";
                switch (type) {
                    case "hash":
                        url = $win.location.href.split("#")[1] || "";
                        break;
                    case "search":
                        // é¿å…hashä¸è§„èŒƒæƒ…å†µ
                        url = $win.location.href.split("?")[1] || "";
                        url = url.split("#")[0];
                        break;
                }
                strs = url.split("&");
                for (i = 0; i < strs.length; i++) {
                    theRequest[strs[i].split("=")[0]] = unescape(
                        strs[i].split("=")[1]
                    );
                }
                return theRequest;
            }
            //åœ¨è¿™éªŒè¯ç™»å½•ä¿¡æ¯
            const useInfoUrl =`${getEvt()}api-tenant.fit.dmall.com/jichu/ryqx/sso/client/isLogin`

            fetch(useInfoUrl,{
                    credentials: 'include',}
                   ).then(response => response.json())
                    .then(res => {
                        if(res && res.code === '0000' && !res.data){
                            // ç”¨æˆ·æœªç™»å½•
                        const returnUrl = window.location.href;
                        CabinX.go(
                            `${EVT
                            }partner.fit.dmall.com/login?redirectURL=${
                                encodeURIComponent(returnUrl)
                            }#full/dmall_fit_jichu_sso_front/ssologin`,
                        );
                        }
                   })
            
            
            
        })
        
        ();
    </script>
    <script>
        var isMedusaPro = false;
        var MedusaProHash = "";
        var count = 0;

        // var helpCenterMapKey = {
        //     'prd': {
        //         appId: 'xlPkiuPd',
        //         appSecret: 'E71BA784A2A751295B36B500D76E9E40'
        //     },
        //     'test': {
        //         appId: 'vauNJAZD',
        //         appSecret: 'F4C50C6E0F64D9E17C1B368DCDB3E252'
        //     },
        //     'rd-': {},
        //     'dev': {}
        // };
        // ç»•è¿‡æµè§ˆå™¨è‡ªèº«è·¯ç”±bug
        window.onload = function () {
            // å¸®åŠ©ä¸­å¿ƒå°ç»„ä»¶è®¾ç½®appId appSecret
            // var evt = window.kayak.EVT.replace("//", '') || 'prd';
            // var helpCenter = helpCenterMapKey[evt];
            // window.helpCenterSDK && window.helpCenterSDK.setBaseInfo(helpCenter.appId, helpCenter.appSecret);
            
          
            setTimeout(function () {
                debugger
                //ç‰ˆæœ¬å·ç¡®å®šæ›´æ–°åä¸èµ°ç¼“å­˜
                var version = 202210251427;
                window.kayak.Loader.loadCss(version);
                window.kayak.Loader.loadJs(function () {
                    FastClick.attach(document.body);
                    
                    //ç°åº¦ç¼“å­˜
                    var userRouteKey = getCookie('aladdin_route_key') || '';
                    var grayData = getGrayData(); 

                    //è·å–ç°åº¦æ•°æ®
                    function getGrayData() {
                        //æ¥å£æŒ‚æ‰,èµ°æœ¬åœ°ç¼“å­˜
                        if (typeof aladdinChart === 'undefined') {
                            console.log('[Aladdin Chart] é¡¹ç›®å•å…ƒã€ç°åº¦é…ç½® fetch error');

                            return getProjectMapCache();

                        }

                        return aladdinChart
                    }

                    //è¯»å–cookie
                    function getCookie(b) {
                        var c = new RegExp("(^|;|\\s+)" + b + "=([^;]*)(;|$)"),
                            a = document.cookie.match(c);
                        if (window.navigator.userAgent.match(/dmall/i)) {
                            //isDmallapp
                            return !a ? "" : decodeURI(a[2]);
                        }
                        return !a ? "" : unescape(a[2]);
                    };

                    //è®¾ç½®cookie
                    function setCookie(name, value, domain, daysToLive) {
                        // å¯¹ cookie å€¼è¿›è¡Œç¼–ç ä»¥è½¬ä¹‰å…¶ä¸­çš„åˆ†å·ã€é€—å·å’Œç©ºæ ¼
                        var cookie = name + "=" + encodeURIComponent(value);

                        if (typeof daysToLive === "number") {
                            /* è®¾ç½® max-age å±æ€§ */
                            cookie += "; max-age=" + (daysToLive * 24 * 60 * 60);
                        }

                        if(typeof domain === 'string') {
                            cookie+=";domain="+domain;
                        }
                        cookie+=";path=/"
                        document.cookie = cookie;
                    }
                    /** 
                     * æ£€æŸ¥å½“å‰hashé‡Œçš„æ–‡ä»¶ç›®å½•æ˜¯å¦å‘½ä¸­ç°åº¦
                     * 
                     * **/

                    //æ£€æŸ¥æ˜¯å¦æœ‰ç°åº¦æ–‡ä»¶å¤¹
                    function checkDir(){
                        const {list=[]} = grayData;
                        const {hash} = window.location
                        let target = hash && hash.split('/')[1];
                        target = target.split('/')[0]; 

                        if(list.map(i=>i.dir).includes(target)){
                            return true
                        }

                        return false
                    }

                    //hashChangeçš„æ—¶å€™å»æ£€éªŒå…¨é“¾è·¯ç°åº¦
                    function checkGrayFlag(){
                        
                        initGrayCookie();

                        if(checkDir()){
                            setGrayFlag();
                        }

                    }

                    /**
                     * ç”Ÿæˆå•å…ƒã€ç°åº¦èµ„æº ProjectMap
                     * @parma {string} path é¡¹ç›®è·¯å¾„ä¸­ hash
                     */
                    function generateProjectMap() {

                        initGrayCookie();
                       
                        var kayakPrefixPath = window.kayak.EVT + 'static.fit.dmall.com/';
                        var projectMap = {}
                        const {list} = grayData;

                        list && list.forEach(cur=>{
                            projectMap[cur.dir] = kayakPrefixPath + cur.path;
                        })

                        //åˆ¤æ–­éœ€ä¸éœ€è¦å…¨é“¾è·¯æŸ“è‰²
                        if(checkDir()){
                            setGrayFlag();
                        }

                        console.log('[Aladdin Chart] projectMap: ', grayData);

                        setProjectMapCache();
                        return projectMap;
                    }

                    //å…¨é“¾è·¯ç°åº¦æŸ“è‰²
                    function setGrayFlag(){
                        const {fullGrayCookie={}} = grayData;
                        const {name,value,domain} = fullGrayCookie;

                        if(domain && name &&value){
                            const domainArr = domain.split(',');

                            domainArr.forEach(domain=>{
                                setCookie(name,value,domain,1);
                            })
                        }
                    }

                    //åˆå§‹åŒ–å…¨é“¾è·¯ç°åº¦cookie
                    function initGrayCookie(){
                        const {fullGrayCookie={}} = grayData;
                        const {name,domain} = fullGrayCookie;

                        if (name && domain) {
                            const domainArr = domain.split(',');

                            domainArr.forEach(domain => {
                                setCookie(name, '', domain)
                            })
                        }

                    }

                      /**
                        * è®¾ç½®ç¼“å­˜ ProjectMap
                        * @parma {string} user ç”¨æˆ·åŠ ç›æ ‡ç¤º
                        */
                    function setProjectMapCache() {
                        if(userRouteKey){
                            let storageKey = 'aladdin_fit_chart_' + userRouteKey;

                            localStorage.setItem(storageKey, JSON.stringify(grayData));
                        }
                    }

                   /**
                     * è·å–ç¼“å­˜ ProjectMap
                     * @parma {string} user ç”¨æˆ·åŠ ç›æ ‡ç¤º
                     */
                    function getProjectMapCache() {
                            if(userRouteKey){
                                let storageKey = 'aladdin_fit_chart_' + userRouteKey;

                                return JSON.parse(localStorage.getItem(storageKey)||'{}');
                            }

                            return {}
                            
                    }
                    //seajs  é€»è¾‘
                    seajs.config({
                        EVT: window.kayak.EVT,
                        kayak: {
                            version: version,
                            updateVersion: true,
                            cellular: false,
                            projectMap: generateProjectMap(),
                            douCoreUse:['cabinx_app_runtime/lib/xPartnerAPI'],
                            cache: {
                                main: false // mainä¸ç¼“å­˜
                            },
                            //tplèµ„æºé“¾æ¥åæ·»åŠ è‡ªå®šä¹‰å‚æ•°
                            getTplUri: function (url) {
                                // é€‚é…ç°åº¦éœ€æ±‚ï¼Œç»™æ¥å®¢é¡¹ç›®çš„tplæ·»åŠ ç›¸åº”å‚æ•°
                                var curVisitUrl = window.location.href;

                                //æ˜¯å¦æ¥å®¢å†…è·¯è¾¹è®¿é—®

                                var userId = getCookie("user_id");
                                // venderKey =window.kayak.EVT.indexOf("dev") > -1? "dev": window.kayak.EVT.indexOf("test") > -1? "test": "prd",
                                // venderId = getCookie(venderKey + "_dmall_vender");

                                //tpl urlä¸Šæ·»åŠ å‚æ•°
                                var modifyUrl = function (curRequestUri) {
                                    var flag = curRequestUri && curRequestUri.split(
                                            ".tpl?") && curRequestUri.split(".tpl?")
                                        .length > 1 ? true : false; //æ˜¯å¦å·²ç»å¸¦å‚æ•°
                                    var tag = flag ? "&" : "?";
                                    var modifiedRequestUri = curRequestUri + tag +
                                        "userId=" + userId;

                                    return modifiedRequestUri;
                                };

                                if (url.indexOf(",") > -1) {
                                    //æœ‰å¤šä¸ªèµ„æºåˆå¹¶è¯·æ±‚
                                    var requestUriGroup = url.split(",");

                                    for (var i = 0; i < requestUriGroup.length; ++i) {
                                        requestUriGroup[i] = modifyUrl(
                                            requestUriGroup[i]
                                        );
                                    }
                                    url = requestUriGroup.join(","); //åˆå¹¶url
                                } else {
                                    //å•ä¸ªèµ„æºè¯·æ±‚
                                    url = modifyUrl(url);
                                }

                                return url;
                            }
                        }
                    });

                    /*********************** 404é€»è¾‘ ***********************/

                    var allErrorUrlObj = []; //å…¨éƒ¨è¯·æ±‚å¤±è´¥çš„urlé›†åˆ

                    //é¡µé¢æ·»åŠ 404æç¤º
                    var appendErrTemp = function () {
                        if ($('body div[data-id="partner404"]').length < 1) {
                            var appendDom = $("body .J_Main").length > 0 ? $("body .J_Main") :
                                $("body");
                            appendDom.append(`
                                <div data-id="partner404" style="position:absolute;top:0;left:0;width:100%;height:100%;z-index:10;background:#fff;">
                                    <div style="height:200px;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);display:flex;align-items:center">
                                        <img src="https://img.dmallcdn.com/dshop/202108/d85c121b-7425-432d-acf1-6a744c7be2fe" width="200px"/>
                                        <div style="width:300px;">
                                            <div style="font-size:18px;color:#1a1a1a;line-height:1.5;font-weight:500;">404</div>
                                            <div style="font-size:14px;color:#666666;line-height:1.5;margin-top:10px">æ‚¨è®¿é—®çš„é¡µé¢ä¸å­˜åœ¨æˆ–é“¾æ¥é”™è¯¯ï¼Œè¯·æ£€æŸ¥æ‰€è¾“å…¥çš„é“¾æ¥æ˜¯å¦æ­£ç¡®</div>
                                        </div>
                                    </div>
                                </div>`);
                        }
                    };

                    //èµ„æºåŠ è½½å¤±è´¥ï¼Œè·³404
                    seajs.on("error", function () {
                        console.log(arguments);
                        //åˆå¹¶æ•°ç»„å¹¶å»é‡ å‡½æ•°
                        var uniqueArr = function (arr1, arr2) {
                            var arr3 = arr1.concat(arr2);
                            var arr4 = [];
                            if (arr3.length == 1) {
                                arr4 = arr3;
                            }
                            for (var i = 0, len = arr3.length; i < len; i++) {
                                if (arr4.indexOf(arr3[i]) === -1) {
                                    arr4.push(arr3[i]);
                                }
                            }
                            return arr4;
                        };

                        if (!arguments || (arguments && arguments.length < 1)) {
                            return;
                        }

                        var requestUri = []; //é”™è¯¯è¯·æ±‚åœ°å€åˆ—è¡¨
                        var curPath = kayak.router && kayak.router.currentPath; //å½“å‰hash

                        for (var i = 0; i < arguments.length; ++i) {
                            var errUri =
                                arguments[i] && arguments[i].uri ?
                                arguments[i].uri :
                                "";
                            var curUrls = errUri && errUri.split("??") && errUri.split(
                                "??")[1] ? errUri.split("??")[1] : "";
                            var curUrl = [];
                            if (curUrls) {
                                curUrls.indexOf("?") > -1 ? (curUrls = curUrls.split("?")[
                                    0]) : curUrls;
                                curUrls.indexOf(",") > -1 ? (curUrl = curUrls.split(",")) :
                                    (curUrl = [curUrls]);
                            }

                            if (curUrl && curUrl.length > 0) {
                                requestUri = uniqueArr(requestUri, curUrl);
                            }
                        }

                        if (!requestUri || (requestUri && requestUri.length < 1)) {
                            //è¯·æ±‚å¤±è´¥åœ°å€ä¸å­˜åœ¨å­˜åœ¨
                            return;
                        }

                        var requestUriStr = requestUri.join(",");

                        var pathArr = kayak.router.currentPath.split("/");
                        var projectName = pathArr[1]; //é¡¹ç›®åç§°
                        var pageName = pathArr[pathArr.length - 1]; //é¡µé¢åç§°

                        pathArr.splice(0, 2);
                        pathArr.splice(pathArr.length - 1, 1);

                        var centerPath = pathArr && pathArr.length > 0 ? pathArr.join("/") :
                            ""; //è·¯å¾„ä¸­é—´ç»„æˆéƒ¨åˆ†
                        var curPageUrl = "/" + projectName + "/" + "pages/" + (centerPath ?
                                centerPath + "/" : "") + pageName + "/" + pageName +
                            ".js"; //å½“å‰é¡µé¢jsè·¯å¾„

                        if (requestUriStr.indexOf(projectName + "/main/main.js") > -1 ||
                            requestUriStr.indexOf(curPageUrl) > -1) {
                            allErrorUrlObj = uniqueArr(
                                allErrorUrlObj,
                                requestUri
                            ); //åˆå¹¶é”™è¯¯è¯·æ±‚url
                            appendErrTemp(); //æ’å…¥404æç¤º
                        }
                    });

                    /*********************** 404é€»è¾‘ end ***********************/

                    //è·å–cookie
                    function getCookie(name) {
                        var arr, reg = new RegExp("(^| )" + name + "=([^;]*)(;|$)");
                        if ((arr = document.cookie.match(reg)))
                            return unescape(arr[2]);
                        else
                            return null;
                    }

                    var sizeType = getCookie("partner_style_size");
                    var cssSuffix = ""; //cssèµ„æºåç¼€

                    if (!sizeType) {
                        cssSuffix = "";
                        window.cabinSize = "normal";
                        window.cabinxSize = "small";
                    } else {
                        cssSuffix = sizeType == "normal" ? "" : "-" + sizeType;
                        window.cabinSize = sizeType;
                        window.cabinxSize = sizeType;
                    }

                    
                    seajs.use(
                        [
                            'kayak/core/kayak',
                            'cabincore/lib/vue/vue',
                            'cabinx/core/0.6.0/core',
                            'dmall_fit_jichu_partner_front/layout/widgets/tab/tabController',
                            'dmall_fit_jichu_partner_front/layout/widgets/partnerAPI/partnerAPI',
                            'cabinx/util/config.js',
                            'dmall_fit_jichu_partner_front/layout/widgets/header/MessMonitor'
                        ],
                        function (kayak, vue, cabinx, TabController, PartnerAPI, cabinxConfig,msIns) {

                            // è·å– TabController å•ä¾‹
                            window.xPartnerTabController = TabController.getInstance();
                            // åˆå§‹åŒ– å£³æ¡†æ¶ç›¸å…³  API ç»™ç›¸å…³æ–¹è°ƒç”¨
                            window.xPartnerAPI = PartnerAPI.getInstance(xPartnerTabController);
                            window.Biz = window.xPartnerAPI;
                            //è§£å†³ä¸šåŠ¡é¡µé¢æ”¹æ ‡é¢˜å½±å“åˆ°æµè§ˆå™¨é¡µç­¾
                            Object.defineProperty(document,'title',{
                                set(value){
                                    console.info(`${window.location.hash}å°è¯•ä¿®æ”¹æ ‡é¢˜å¤±è´¥ï¼Œä¿®æ”¹å€¼ä¸º${value}`)
                                },
                                get(){
                                    return 'å¤šç‚¹é£æ‹“'
                                } 
                            })

                            // CabinX æ–¹æ³•æ‹“å±•ä»…åœ¨ PC ç«¯ä½¿ç”¨
                            if (cabinx.device.isPC) {
                                // å®ç° CabinX ç›¸å…³ API
                                cabinx.extends({
                                    // è·¯ç”±ç›¸å…³
                                    router: {
                                        // close tab
                                        close: function(url) { 
                                            console.log('ğŸ”§ [cabinx.extends.close]', url);

                                            if(url === undefined){ //å…³é—­å½“å‰
                                                return window.xPartnerAPI.closeActivatedTab();
                                            }
                                            // å…³é—­å¯¹åº”çš„ url tabé¡µé¢
                                            window.xPartnerAPI.closeTab(url);
                                        },
                                        refreshTab: function(url) { 
                                            console.log('ğŸ”§ [cabinx.extends.refreshTab]');
                                            // åˆ·æ–° tabé¡µé¢
                                            window.xPartnerAPI.refreshTab();
                                        },
                                        replace: function(url, options){
                                            window.xPartnerTabController.replaceTab(url,options)
                                        }
                                    }
                                });
                            }

                            // å…¨å±€åˆ†éš”ç¬¦é…ç½®ï¼Œç”¨äº CabinxConfig
                            const separatorsSettings = [
                                [ //åˆ†éš”ç¬¦
                                    '\s', // åŒ¹é…æ‰€æœ‰ç©ºç™½ç¬¦,
                                    ',','ï¼Œ', // è‹±æ–‡é€—å·ï¼Œä¸­æ–‡åŠè§’ï¼å…¨è§’é€—å·
                                    ';','ï¼›', // è‹±æ–‡åˆ†å·ï¼Œä¸­æ–‡åŠè§’ï¼å…¨è§’åˆ†å·
                                    'ã€‚', // è‹±æ–‡å¥å·ï¼Œä¸­æ–‡å…¨è§’å¥å·
                                    'ã€', // ä¸­æ–‡å…¨è§’é¡¿å·(è¥¿æ–¹è¯­è¨€ä¸å­˜åœ¨é¡¿å·)
                                    '|','/', // è‹±æ–‡åˆ†éš”ç¬¦å·
                                ], 
                                ',' // é»˜è®¤è¿æ¥ç¬¦ï¼š',' (è‹±æ–‡é€—å·)
                            ];

                            cabinxConfig.setConfig({
                                // åˆå§‹åŒ–æ¸ é“ç‰ˆæ ·å¼
                                ui: {
                                    themeConfig: {
                                        checkbox: {
                                            checkboxClassName: 'qudao',
                                        },
                                        button: {
                                            secondary: 'secondary-qudao'
                                        },
                                        tabs: {
                                            headerBackground: 'qudao'
                                        },
                                        form: {
                                            formSearchBackground: 'qudao',
                                            choiceTriggerBackground: 'qudao',
                                            notStayInitLayout:true,
                                        },
                                        module:{
                                            moduleBackgroundColorClass:'qudao'
                                        },
                                        tag: {
                                            statusStyle: 'noDot',
                                        }
                                    },
                                    layoutConfig: {
                                        pageLayoutResizeable: true,
                                        layoutPadding: 8,
                                        tabsPopUpActions: false,
                                        actionsTurned: true,
                                    },
                                },
                                // æƒé™æ ¡éªŒ
                                auth: {
                                    authPrivilege(authCode) {
                                        return window.Biz.authPrivilegeSync(authCode);
                                    }
                                },
                                datepicker: {
                                    daterange: {
                                        shortcuts: [
                                            {
                                                text: 'ä»Šå¤©',
                                                onClick(picker) {
                                                    picker.$emit('pick', [new Date(), new Date()]);
                                                },
                                            },
                                            {
                                                text: 'æ˜¨å¤©',
                                                onClick(picker) {
                                                    const time = Date.now() - 1000 * 3600 * 24;
                                                    picker.$emit('pick', [new Date(time), new Date(time)]);
                                                },
                                            },
                                            {
                                                text: 'è¿‡å»7å¤©',
                                                onClick(picker) {
                                                    picker.$emit('pick', [
                                                        new Date(Date.now() - 1000 * 3600 * 24 * 7),
                                                        new Date(),
                                                    ]);
                                                },
                                            },
                                            {
                                                text: 'è¿‡å»15å¤©',
                                                onClick(picker) {
                                                    picker.$emit('pick', [
                                                        new Date(Date.now() - 1000 * 3600 * 24 * 15),
                                                        new Date(),
                                                    ]);
                                                },
                                            },
                                            {
                                                text: 'è¿‡å»30å¤©',
                                                onClick(picker) {
                                                    picker.$emit('pick', [
                                                        new Date(Date.now() - 1000 * 3600 * 24 * 30),
                                                        new Date(),
                                                    ]);
                                                },
                                            },
                                        ],
                                    },
                                },
                                input: {
                                    text: {
                                        separators: separatorsSettings,
                                    },
                                    scan: {
                                        separators: separatorsSettings,
                                    },
                                },
                                select: {
                                    separators: separatorsSettings,
                                },
                                cascader: {
                                    separators: separatorsSettings,
                                },
                            });
                    
                            // æå‰åˆå§‹åŒ–åŸæœ‰ cabincore ä¸­ momentï¼Œå› é¡¹ç›®ä¼šéšå¼å¼•ç”¨
                            Vue.prototype.moment = window.moment;

                            //åˆå§‹åŒ–åŸ‹ç‚¹projectName
                            window.DmallTracker && window.DmallTracker.instance('partner_pc');

                            //å°è£…ä¸€ä¸ªç‚¹å‡»äº‹ä»¶åŸ‹ç‚¹
                            window.xPartner_clickTrack = (element_id, element_name) => {
                                window.DmallTracker.track('element_click', {
                                    page_url: window.location.href,
                                    element_id,
                                    element_name,
                                    module:{
                                        p:'-1',
                                        r:'-1',
                                        k:'-1',
                                        i:'-1',
                                        n:'é£æ‹“å•†æˆ·å¹³å°-pc'
                                    }
                                })
                            }

                            window.Biz.getSystemConfig().then(function(result) {
                                console.groupCollapsed(`âš™ [Biz] getSystemConfig`);
                                console.info('%c result  ', 'color: #2196F3;', result);
                                console.groupEnd();
                                
                                cabinxConfig.setConfig({
                                    // æ ¼å¼åŒ–
                                    formatter: Object.assign({}, result),
                                });
                            })
                            

                            // éšè—loading
                            let $bodyLoading = $(".body-loading");
                            $(".body-loading").removeClass("show");
                            setTimeout(function () {
                                $bodyLoading.remove();
                            }, 800);

                            var router = cabinx.router;

                            router.on("preJump", function (e) {
                                console.groupCollapsed(`âº [Kayak Router] preJump @ ${new Date().toLocaleTimeString()}.${new Date().getMilliseconds()}`);
                                console.info('%c data  ', 'color: #2196F3;', e);
                                console.groupEnd();

                                if (e.pathData && e.pathData.dmalllink == "" && e
                                    .pathData.web == "") {
                                    kayak.router.replace(
                                    "#index/dmall_fit_jichu_partner_front/homepage"); //é»˜è®¤å»çš„é¡µé¢
                                    return;
                                }

                                // ä¸šåŠ¡ç³»ç»Ÿå°è¯•æ‰“å¼€çš„æ— æƒé™é¡µåå•
                                const notPermissionPath = [
                                    'index/atlas_h5/notPermission',
                                    'index/dmall_live_cabin/nopermissions',
                                    '#full/partner/nopermissions',
                                    '#index/partner/nopermissions',
                                    '#full/esc/nopermissions',
                                    '#index/esc/nopermissions',
                                ].join('');

                                // æ— æƒé™æ‰“å¼€ æ–°tab æ‹¦æˆª
                                // dmalllink:-1 web: -1 ä¸ºç§»åŠ¨ç«¯ 
                                if (e.pathData && e.pathData.dmalllink !== -1 && notPermissionPath.indexOf(e.pathData.dmalllink.split('#')[1]) !== -1) {
                                    const currentPath = window.kayak.router.currentPath;

                                    console.info('[PartnerTab]: inner project trying to open notPermission, path: #' + currentPath);
                                    window.xPartnerTabController.setTabNoPermission('#'+ currentPath);
                                    return false;
                                }
                            });

                            router.on("parseMain", function (pathObj) {
                                var projectName = pathObj.path.split("/")[1];
                                pathObj.mainPath = projectName + "/main/main";
                            });

                            function getLastSubPath(path) {
                                var last = path[path.length - 1];

                                return last.split(':').shift().concat('/', last);
                            }

                            // æ˜¯å¦æ˜¯éœ€è¦æ— æ¡†æ¶å±•ç¤ºé¡µé¢
                            var isFullPage = function(path) {
                                return (path || '').indexOf('full/') !== -1
                            }

                            //è·¯ç”±è§£æ
                            router.on("parseActions", function (p) {
                                console.groupCollapsed(`â© [Kayak Router] parseActions @ ${new Date().toLocaleTimeString()}.${new Date().getMilliseconds()}`);
                                console.info('%c path      ', 'color: #2196F3;', p.path);
                                console.info('%c fullPath  ', 'color: #2196F3;', p.fullPath);
                                console.info('%c pathData  ', 'color: #2196F3;', p);
                                console.groupEnd();

                                // å¦‚æœå·²ç»å­˜åœ¨äº æ‰“å¼€ tab åˆ—è¡¨ && æŒ‚è½½å®Œæˆï¼Œæ‰§è¡Œ tab åˆ‡æ¢ä¸åŠ è½½
                                if (p && p.fullPath && window.xPartnerTabController && !isFullPage(p.fullPath)) {
                                    var tab = window.xPartnerTabController.getTab('#' + p.fullPath);
                                    // å­˜åœ¨ tab åˆ—è¡¨
                                    if (tab && tab.pathData) {
                                        var isMountComplete = tab.pathData.actionOptions ? tab.pathData.actionOptions.isMountComplete : false;
                                        // æŒ‚è½½å®Œæˆ
                                        if (isMountComplete) {
                                            window.xPartnerTabController.pureActiveTab('#' + p.fullPath)
                                            return false;
                                        }
                                    }
                                }


                                /*********************** 404é€»è¾‘ ***********************/
                                //ç§»é™¤404æç¤º
                                if ($('div[data-id="partner404"]').length) {
                                    $('div[data-id="partner404"]').remove();
                                }
                                /*********************** 404é€»è¾‘ end ***********************/

                                var pathLen = (p.fullPath + "").split("/").length,
                                    path = (p.path + "").split("/");
                                if (path.length == 1) {
                                    p.actionPath = "dmall_fit_jichu_partner_front/layout/" + path[0] + "/" +
                                        path[0];
                                }
                                if (pathLen < 4) {
                                    if (path.length == 3) {
                                        p.actionPath = path[1] + "/pages/" + getLastSubPath(path);

                                        /*********************** 404é€»è¾‘ ***********************/
                                        var allErrorUrl = allErrorUrlObj.join(",");
                                        if (allErrorUrl.indexOf(p.actionPath + ".js") >
                                            -1) {
                                            appendErrTemp(); //æ’å…¥404æç¤º
                                        }
                                        /*********************** 404é€»è¾‘ end ***********************/
                                    }
                                } else {
                                    if (path.length == pathLen) {
                                        var centerPath = "";
                                        for (var i = 2; i < pathLen - 1; ++i) {
                                            centerPath += path[i] + "/";
                                        }

                                        p.actionPath =
                                            path[1] +
                                            '/pages/' +
                                            centerPath +
                                            getLastSubPath(path)

                                        /*********************** 404é€»è¾‘ ***********************/
                                        var allErrorUrl = allErrorUrlObj.join(",");
                                        if (allErrorUrl.indexOf(p.actionPath + ".js") >
                                            -1) {
                                            appendErrTemp(); //æ’å…¥404æç¤º
                                        }
                                        /*********************** 404é€»è¾‘ end ***********************/
                                    }
                                }

                                // é #full/xxxx/xxx æ—¶ è¿›å…¥ tab é€»è¾‘
                                if (!isFullPage(p.fullPath)) {
                                    // actionOptions éç›´æ¥èµ‹å€¼ä¸ºå¯¹è±¡ï¼Œå›  xPartnerTabController éœ€è®¾ç½®äº‹ä»¶ actionOptions.onBeforeTitleChange
                                    if (typeof p.actionOptions === 'undefined' || p.actionOptions === null) {
                                        p.actionOptions = {};
                                    }
                                    // æŒ‚è½½ action å¯¹åº”çš„ç›®æ ‡ container
                                    p.actionOptions.container = window.xPartnerTabController.getContainer(p);
                                    // åˆå§‹åŒ– æŒ‚è½½ å®ŒæˆçŠ¶æ€
                                    p.actionOptions.isMountComplete = false;
                                }

                            });

                            router.on('loadComplete', function(p) {
                                const actions = p.actions;
                                const currentAction = actions[actions.length - 1];

                                if (actions.length === 0 || isFullPage(currentAction.fullPath)) {
                                    return;
                                }

                                console.groupCollapsed(`â© [Kayak Router] ResourceLoadComplete : ${currentAction.fullPath}`);
                                console.info('%c actions  ', 'color: #2196F3;', p);
                                console.info('%c router.currentPath  ', 'color: #2196F3;', router.currentPath);
                                console.info('%c currentAction.fullPath  ', 'color: #2196F3;', currentAction.fullPath);
                                console.groupEnd();

                                // æŒ‚è½½æ‰§è¡Œæ—¶ fullPath å’Œ currentPath ä¸åŒæ—¶ä¼šåœæ­¢ï¼Œä¿æŒ isMountComplete ä¸º false
                                if (currentAction.fullPath !== router.currentPath) {
                                    console.groupCollapsed(`ğŸ˜ˆ [Kayak Router] MountNotComplete : ${currentAction.fullPath}`);
                                    console.info('%c é¡µé¢æŒ‚è½½æœªå®Œæˆ      ', 'color: #2196F3;', );
                                    console.info('%c router.currentPath  ', 'color: #2196F3;', router.currentPath);
                                    console.info('%c currentAction.fullPath  ', 'color: #2196F3;', currentAction.fullPath);
                                    console.groupEnd();
                                    return;
                                }

                                // æŒ‚è½½æˆåŠŸåˆ™ä¿®æ”¹ isMountComplete
                                if (currentAction.actionOptions) {
                                    currentAction.actionOptions.isMountComplete = true;
                                    console.info(`âœ… [Kayak Router] mountComplete : ${currentAction.fullPath}`);
                                }
                            });

                            router.on('preEachExit', function(p) {
                                return isFullPage(p.action && p.action.fullPath);
                            });

                            router.start({
                                multiInstanceAsDiffParam: true,
                            });
                        }
                    );
                    

                    // å»¶å Cabin Core ç›¸å…³ä¾èµ–åŠ è½½ï¼Œä»…åœ¨ main.js å…¥å£æ˜¯é CabinX æ—¶æ‰§è¡Œ
                    seajs.on('define', function (data) {
                        // åˆ¤æ–­æ˜¯é¡µé¢ä¸”ä¸æ˜¯ CabinX é¡¹ç›®ï¼Œåˆ™éœ€è¦æå‰åŠ è½½ Cabin ç›¸å…³ä¾èµ–
                        // ä½¿ç”¨é¡¹ç›® main.js ä¸­æ˜¯å¦åŒ…å« #requireTarget# æ¥è¿›è¡Œ CabinX ç‰¹æ€§æ£€æµ‹
                        if (
                            data && data.id && data.id.split('/') &&
                            data.id.indexOf('/main/main') > 0 &&
                            data.deps && data.factory.toString().indexOf('#requireTarget#') < 0
                        ) {
                            console.groupCollapsed(`ğŸ”§ [Kayak deps analysis] @ ${new Date().toLocaleTimeString()}.${new Date().getMilliseconds()}`);
                            console.info('%c define id  ', 'color: #2196F3;', data.id);
                            console.info('%c define deps', 'color: #2196F3;', data.deps);
                            console.info('%c define data', 'color: #4CAF50;', data);
                            console.info('%c define factory', 'color: #4CAF50;', data.factory.toString());
                            console.groupEnd();

                            // ç”¨æˆ·å¯èƒ½ä¼šæå‰è®¾ç½® Cabinï¼Œå¦‚ pageConfig ç­‰
                            if (window.cabin && window.cabin.Page) {
                                console.groupCollapsed(`ğŸ”§ [Kayak deps analysis] cabin exist @ ${new Date().toLocaleTimeString()}.${new Date().getMilliseconds()}`);
                                console.info('%c define data', 'color: #4CAF50;', data);
                                console.groupEnd();
                                return;
                            }
                            var cabinFiles = [
                                'cabincore/core/cabin',
                                'cabincore/style/base.css',
                                'cabin/theme/partner/partnerup' + cssSuffix + '.css',
                                'cabinpro/theme/partner/partner' + cssSuffix + '.css'
                            ];

                            // æ·»åŠ  Cabin ç›¸å…³ä¾èµ–
                            data.deps = cabinFiles.concat(data.deps);

                            var factoryFn = data.factory;
                            data.factory = function (require, exports, module) {
                                // åœ¨é¡µé¢é€»è¾‘ä¹‹å‰æå‰æ‰§è¡Œ Cabin
                                require('cabincore/core/cabin');
                                return factoryFn(require, exports, module);
                            };

                            console.groupCollapsed(`ğŸ”§ [Kayak deps analysis] deps do refactor @ ${new Date().toLocaleTimeString()}.${new Date().getMilliseconds()}`);
                            console.info('%c define id  ', 'color: #2196F3;', data.id);
                            console.info('%c define deps  ', 'color: #2196F3;', data.deps);
                            console.info('%c new define data', 'color: #4CAF50;', data);
                            console.groupEnd();
                        }
                    });

                    function initSeajsEventInDiffParamMode(seajs) {
                        function getUriInfo() {
                            var hash = /^#(?:full|index)\/(\S+)\:(\S+)$/.exec(
                                window.location.hash
                            );

                            if (!hash) {
                                return null;
                            }

                            var subPaths = hash[1].split('/');

                            subPaths = subPaths
                                .slice(0, 1)
                                .concat(
                                    'pages',
                                    subPaths.slice(1),
                                    subPaths[subPaths.length - 1]
                                );
                            return { path: subPaths.join('/'), args: hash[2] };
                        }

                        seajs.on('define', function (eventArgs) {
                            var uriInfo = getUriInfo();

                            if (!uriInfo || uriInfo.path !== eventArgs.id)  {
                                return;
                            }

                            var args = ':'.concat(uriInfo.args);

                            eventArgs.id += args;
                            eventArgs.uri = eventArgs.uri.replace('.js', args + '.js');
                        });

                        seajs.on('fetch', function (eventArgs) {
                            var requestUri = eventArgs.requestUri;
                            var uriInfo = getUriInfo();

                            if (!uriInfo) {
                                return;
                            }

                            var path = uriInfo.path;
                            var args = uriInfo.args;

                            if (requestUri.indexOf(path.concat(':', args, '.js')) === -1) {
                                return;
                            }

                            args = ':'.concat(args);
                            eventArgs.requestUri = eventArgs.requestUri.replace(args + '.js', '.js').concat('&', args);
                        });
                    }
                    // Seajs æ”¯æŒå‚æ•°ç±»å‹æ”¯æŒ
                    initSeajsEventInDiffParamMode(seajs);

                    window.addEventListener('hashchange', () => {
                        //å…¨é“¾è·¯ç°åº¦é€»è¾‘
                        checkGrayFlag();
                    })
                }, version);
            }, 1);
        };
    </script>
</body>

</html>
